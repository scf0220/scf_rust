package main

import (
	"context"
	"crypto/ecdsa"
	"encoding/hex"
	"fmt"
	"github.com/ethereum/go-ethereum/core/types"
	"log"
	"math/big"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/crypto"
	"github.com/ethereum/go-ethereum/ethclient"
)

func main() {
	// 连接到以太坊客户端
	client, err := ethclient.Dial("https://rpc.ankr.com/eth_sepolia/578c95407e7831f0ac1ef79cacae294dc9bf8307121ca9fffaf1e556a5cca662")
	if err != nil {
		log.Fatal(err)
	}

	// 私钥 (一定要保密)
	privateKey, err := crypto.HexToECDSA("51a3a2416d01818757c86c897b88bd5bb0c8c819407dc9cab6b6df553ccd4c2c")
	if err != nil {
		log.Fatal(err)
	}

	// 获取公钥
	publicKey := privateKey.Public()
	publicKeyECDSA, ok := publicKey.(*ecdsa.PublicKey)
	if !ok {
		log.Fatal("cannot assert type: publicKey is not of type *ecdsa.PublicKey")
	}

	// 从公钥生成地址
	fromAddress := crypto.PubkeyToAddress(*publicKeyECDSA)
	fmt.Println("From Address:", fromAddress.Hex())

	// 获取nonce值
	nonce, err := client.PendingNonceAt(context.Background(), fromAddress)
	if err != nil {
		log.Fatal(err)
	}

	// 设置交易参数
	value := big.NewInt(0)     // 发送1 ether
	gasLimit := uint64(956684) // 标准交易的gas限制
	gasPrice, err := client.SuggestGasPrice(context.Background())
	if err != nil {
		log.Fatal(err)
	}

	// 接收地址
	toAddress := common.HexToAddress("0x1be3c587b108c4448eb21949ac56b87a2ea178fc")
	data, err := hex.DecodeString("4202fc9a00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000dc00000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000010c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000680d5abd7b8c3c2e07ba23972710477040d41804eb237ec714623a85ac0d25a0b52284824e3e3843ec6eb7e6478e3e1551519ebd509fb234ccd241e292f5ac112e05bc2490e00b86a4b50ffbaf2d23c948324a120884f22b6fceba6a3d344ec4d22a94dd7939b423e29765c1f198b5de8ba9afda5d3ed24d48e8ed277ee73c268a23df59629c1783a6cb4d1886f95dacfa256081b4a00bb8cdd55ab0db594cbc3d1f73ee74d1d13f1ec47d2632e177c45a5c883c43205db522f50ff7f2bbc877b6034534a2ba754a6d731701492cdcb8f0df2304d150b9c69c80f71684149e1c3b1649854ac5a806d2091532cb623509f1c67bf583d7add44ef86457815bb617fd21bdb3c5bc6d811e7da0b711a2a97df779c0740c0470ad80d8821ef9f65fe18c2bf3ef0ad6db04cb149279d893edaa65ecd1c93132b6d2cc321c13c87cbd3ace26a29c649f13dc2c7b0ccb35990f31f66138e7c0e2f2adbe03880a5595f592bf1d6eb11545a86f4813089b3d98cdf0c8ebf1c5bef9f9e0f22799125fac22c04a106f5cdfd4057ca91fdb2c3e0d2a6ee9f641265924ae92bf68084adfd57d6dc116298c7fa8b2da28e8e06b74988d46c22b21620697f4e602276457c433ff7a9c1a360abcd5c2db50174ce92477ea8cfb6e9c1b4caa603b71a7e203e593980cfe1e6d5c4158e406f3071aae61d35fbb8acdf4f675ed8b54a94730fe3d6a2c0eef2f1f9ec50c579e46c0bd39fce3702c719c05b8c3092f0d3fe1fd5a381df7ccf51f861ecf55644a74229b7fb48d1be6405cd00d4ac30cc9edc5a1dc98400421230573ea314a3d46c7f36b59fe851c782999bbe2000e61aa2f7f2c1be997d861ad23183d358f679bb537750a52b09bfe548d4d0ab07ceced7978fe646f609596650edf6b5e81706322e18b220dd896c920f8e310697a727d215adc1ea3bad3fa762cacd34c3eae09e87aa74dcb80a6e8ce16f730dc1cac5621c59302c19ed24bda1f93dc354257ce12ab35ba6375b6b38938f9e43f93ded6349502e6b5f459eac227eda2700ff5c5d34687218d6767eeb9634fbdfe7645daa66d60cb41ba0b150a06f35604866f1266e98f78540ffc64b369ccc4630da5e4efbc22c4e62a44294309ec38bbbdbc601be5991c4e39c5887786924b6eb6438f9c716bcc1a567cb33208976d1787139bc02372d52703183eae9300bc541e07a7756230f8251ec150cc0949f2b21c0b69e28b0337da14b821c88afc1c6e404c2fdc913e6d28902efc611313eb2016b63eb9d128a0f0e7a9c45258e782506d0cbf8c37c573895856d13e19be703e416b9a15507b866de13d28ae39634287782c5ac609b2f35e8409943a10566deb3dc44b8a66b1b5cd135f7dacb48b328a0f916ba97247bada93c1b8c42da508b3749520650653a933422b3c7454f2b1ba270951c8c2513419303d00830a14354612ffd60a5e1a31c38cf53257f31a2763cb1097f8ac2f09a6294214ea09cd26680c2e31927c5a917dc345ac53b1d9b04d4a0cc42233bce670802e1f4e10160ebff0ac834ae49ded0e07f8b4efd76555433c67fd43c9959e0f7b88922d2b76fcf3ffabc0371ebea2627630c503924bf4c2636298b558333dd87c3c838f15b0c07b3a58fb14ddca7a8b2d9c5821bde2cbbbe5967aa3b5afb9ea653118fe213fd9f08e48dfbc8571370d33151c35b07ea58e64d50b581132ea59868d8c980ece930c8d922ee5a84c2465e53b64056d969680edc529beaeca7242654cabc02d7ed2d7ca60c8f493543669e151c9375706f8a16978a7a752a1e6d500dc73c12043c449aaa24809990f233a5f7275e5b4559fd76bba1bbdee0fbf21f00dc10415968e088e949219f218641c68d22851e854b09c16860a14c1b8466a45bfdf74075a956693e5fa4ed3a3fe6853c9d7e7d8cde65cf272ca1e036191444290ad0d22efafdf398f9b366934de48ee62c190c61286374b82b706342bfc5f122ebdc419b5354b62cf355ee18f6c00a4a52ca66c90f77866ab5a7630524fa862968c4715d6426abe668e6a691f0a02be19d152220b43a440bacf207cac144b449fa2621a78f5d495100590becfbcb370f4d2c09e18483fc7030f50485832a218a410ce03ca2a943643355137c941d590bb539d4501a2fdf65887b481aff40488128af22d11afcf28410eaabaa7ec58cb7a8f8b9707d390b27b6666259760eede0beaf51f711de28bc5e8cd65e9fe0f9702d752beec25a45abfeeacda1f74b9fa1ff1a52d8f87f3258e433a3a0426c7576926f3b81fc8324e5a5e430acf52806e66d85d02cbd997b638fe7de4443525ee6ae827981fceba78c31554b339c87d39bc846b0392674000802d83301fb4dfcbbe472b4a3e768ec6fe76c8dbba38da613f470c0e24a4a6cce34cb43972a1d74881d7de2ae02469545821b53a780c030a065415108ac3cc6eda252e10bb0b5f3b212fd7f3ac4835075df81300d773c0f08981ca13accb36b02aa7a80707cdd01612c0eed6db5330b11abb6ebcd66def68200df425e61c6a2b1a5ba286443307aeb1930942d8e7cc4154770f83e535227c29f612114cc708bc62e5b924428c8eb8649fb05cb56ea2a755d69807b92dd445ed986b110eb63980cb0adfe88f27bdc2ca60ef0fb4dc068bafd504a5f1662c5fce538c08ae42b56123b9a1325c65266f57336dd35c7b93beb5f6223f24d90688e1b780234e62a2a99b2857f3fd4a57acb6992731448fc0f5833b5d64e5551918a1936b207213962b6c8071e40c13c7300eb9e958e2fac7846834a8da420c1bf8f0cd050db47640a59286b40b345ee0939664b46d5f90a207b5bd891ab75ae962f5fb0a01576eb59711a632ee6adc381f03aa21d0949791f1863b0cbfed0425db4a514803bcb0252b0f4642776e2a532e46b46e36c80aa5b014d20c0ed44a6d4c5314c02726c231a3ac011b82d26b53b7f5b706c1c9073595aef197123a2b51cd4a3b7a3043836d6ba39fed4d122da058d9ca24fd6aa71926c43ce06290fda6e5fbbdc72cf62fc826632bd1bd083a47e0d036a725dc87e33f87f1584757a9a9c5fe1bda1636e5de293637d1f2bfde5e66840fc13520b1048473f8ed57bc393b878e2640117ede1607ef03ab6ae163e9eecc82e8862e937de6628fe290d31a64d0f23a4206f53047410c82958fc6be7aa0971cf2b442712c5e74d45bb272f1407f80d25b02ffa38b20fd4a38a0a91429ffd5a4a7d09400a57851d9680e32e239e9f78af212efd06d1def3e1d3a73f1c2db704e7657a4248336289905a490f3064847db5b24bc37cdf0391e813aac7b720a3e4dc0e823e4f96627572669a861be62371c8b17748d03f1a405f0f76fed55793f59d51e87206c1e2ff19e1fe69d06840c1e421e7ce9ff5f38cba413c32bf705c2273b8069a8bf8c0811315f511f6a4066a1c0052df24430003bd64b5a22c441d317a19ae1483fa37b61940d18d8b375fb18b00896a2c87f54b8279553952687b70856b87d7a030342f24913392131cdb3934900361deda7c9c367d5939d004d5fc8064f6cc44497ea45fb2ec449d5acc49a122ca5cf1b041d0b3adeaca84480a62fc7d46bb82e04aeb5c5426999ab9f244f3b28e74ba35f6b048ef3fb7cac20768f07feb3f3cdc986ecd91a8330f6c9b06ac821ea87a939f66e6c3746c8adf9cedbf37d265fc7eef094ae59531449deb1beb31d829cb81a0700e595b4a77c562aa5454c6d3e6b9868e45444c177bef918583a014c1b4e975b1bf8e693a4434edee377a0533f301e72a3e3deebd4bd4c0d273c2545e67a8751cd34a66a72e9878083b9e9d87e23a8c75c242b83fea497d8fd2322933a3d59893039864d564e88fd294a7b979567036bfa393eff316a6fa655f321a05be5944afa31d28c3649701e6766ad9855fb8d9d4d8782b5efa460eade942cb2e1dfc87594e3c1e241bf8e095bd9f9a9db9b98a80384aae19ec311fd4a6a1e8e5cb58b34fb5138ebd3ce70b27ce87b5e02131b1a5c122b94123cd959c46029044224ef4e42414a1c019e160caca14fd67e3f295f33635453d2b8260925d02dfef1975ae85caac0abe69b45d777495e2a97358bdf3f9f43068d5b8642b70016ab2f8bbe4f60cfba7c71c8af185c6183fa0de29a8ab01d3077ef12235e8b3d1d0823d17d394606eb67bf1dff882a7d6f1137999f0e904bb306265f8136a6821d5153fd7c833cd3d6755e0c6d6fd175162ded92525f7b3c93a419e9054f0f6b30619b6f674006cd199e9fd251be697ae70942be1479f723a764eb0b712d1326042e4132f21f12295ff493c9a87d9849fcb8db3b25ec50a0e2e135c2f7291fd105e82c59332ccf938f06d84792f7591b47b8c1cee2b2f117746aff560d7490d30caad8c39d00d78d7e53ff5a6ff25aa025d24c2a52f90e5ff99d5b815ba89705179e85a03c899f2f42d45e02ae9350a8553a51b63367f1dce48a7bc03f26bcd010afcc07f4793a7d9be2a442ccf5b8bdb39159be7415d91b96e9c7b3d4530546287bdd8cc8deb628c97f6e2d88ddf7ba009194cc5a3f9280740f37e5ea28d04c0f97e738fa07cd2c22948edb3f88f82eb1a5177a9c48744378d325d2b86c263a067502a2aaeec1739d0be3c677e8a16d245e14daf50f461c9ec15d4c2f888626247c2f513abb7b5cab4144f87540d2020f4807097a90d7935b2f76b4b5c4721000000000000000000000000000000000000000000000000000000000000000011760673487281a87933156f40a53a46969cc882c0ed465f69cc380001ba0e26a00000000000000000000000000000000000000000000000000000000000000152075c2a14c6dfa24128d979d2ae535cb10bf457b1788f1230df8848cde1b0ded0d336f4fe3a3eb41678cfdaf571ac937f2ea9222ce1fd5dc0011123d5ef337a70fee8bd194c3a605a5c2ae19569c22921774a2cd62307f6e35e9710711e4f2142875d8037c7fd58fb33017cb914606dd3b68493188c8a12e0ee703563fd4fdb92330df22fd8db4e850c348072a668f2535495625ab999ab543d0e356910cc85a07ee766f64b1ca9a05202deaf03b517feccb9f16f0f0cf6334faf23db02b024823b58350ba966419060f7e91cb36b0b3059aa02092ff57299d9c2d95fb9dc0fd0caecb22269b3c10b240c724b64aa7aa22994827e6ba1967a645c7fdf4623f040323555c1c4305b817585ba76acea2e6ef00369d47cbc79b87cb5abf1a7987280c9e7892f3706a46e6ae915abf41499be6f8bb862a698d584d6961d4765c836f19d81360c6f32f42761360fb6003c29eab451435f15d6b7cd7f4a5788ac978612add18ad82a3f75973709421ed6b771171a2daae9df3428e8ed07228c5640f3b0579b886a66505e7d38ca28de34807aafd6a7ac789b90a2d1b234a7baefaf1292964a9cfb9a607e9e71d211ea0a4816c038a52b002eb2c1454de944f6a70eac00e5d0b9db587bad9e05ec4f2dea1bba971c6e9ef346ad9e2a4098208cd6a4fae100eb1994c7d3c3050b39498d354228168ddc58170b427b60b6576daaa663aef28519df88f155e4981d8668adfb9d2824d3901d11253d4e973cec06756ce4a4d11bc9e85cf3ae40774fafdff489330239046982272a131de9fb01fca86f2be1c28bbfdb5fc8461f599c0d356f294eb363bdb1f998a1adbbc43bccd04ab743b271ea7afed11f6bc22435547b738ee283997ed502607183eb2a431d5c9690d41e507a850bce4ad3e341e8f725f8eec6d26ec58c8aeef9e94d50025288f448bc4da00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000061f96cb6aff57754000000000000000000000000000000000000000000000000237b2cbd779f0d980000000000000000000000000000000000000000000000001d9be8cd647aacb60000000000000000000000000000000000000000000000007c8b5f18e9bf5443")
	// 创建交易
	tx := types.NewTransaction(nonce, toAddress, value, gasLimit, gasPrice, data)

	// 签署交易
	chainID, err := client.NetworkID(context.Background())
	if err != nil {
		log.Fatal(err)
	}

	signedTx, err := types.SignTx(tx, types.NewEIP155Signer(chainID), privateKey)
	if err != nil {
		log.Fatal(err)
	}

	// 发送交易
	err = client.SendTransaction(context.Background(), signedTx)
	if err != nil {
		log.Fatal(err)
	}

	fmt.Println("Transaction sent: ", signedTx.Hash().Hex())
}
